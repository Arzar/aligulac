{% load ratings_extras %}

{% if lm_header_event %}
<div class="table numtable" style="width: 67em;">
    <div class="rowh">
        <div class="rowe" style="width: 67em;">
            {% if lm_list.0.eventobj %} ▸
                {% for p in lm_list.0.eventobj.get_path %}
                <a href="/results/events/{{ p.id }}/">{{ p.name }}</a>
                {% endfor %}
            {% elif lm_list.0.event %}
                {{ lm_list.0.event }}
            {% else %}
                Unknown event(s)
            {% endif %}
        </div>
    </div>
</div>
{% endif %}
<div class="table numtable" style="width: 67em;">
    {% if lm_header_info %}
    <div class="rowh">
        <div class="rowe" style="width: 5em;">{% if lm_show_date %}Date{% endif %}</div>
        <div class="rowe" style="width: 7em; text-align: right;">{% if lm_sorted %}Rating{% endif %}</div>
        <div class="rowe" style="width: 18em; text-align: right;">{% if not lm_sorted %}Player A{% endif %}</div>
        <div class="rowe" style="width: 5em; text-align: center">Score</div>
        <div class="rowe" style="width: 18em;">{% if lm_sorted %}Opponent{% else %}Player B{% endif %}</div>
        <div class="rowe" style="width: 7em; text-align: right;">{% if lm_sorted %}Rating{% endif %}</div>
        <div class="rowe" style="width: 5em;"></div>
    </div>
    {% endif %}
    {% for m in lm_list %}
    <div class="row {% cycle 'row2' 'row1' %}">
        <div class="rowe" style="width: 5em;">
            {% if lm_show_date %}{{ m.date|date:"Y-m-d" }}{% endif %}
        </div>
        <div class="rowe" style="text-align: right; width: 7em;">
            {% if lm_sorted %}
                {{ m.rt_my|ratscale }}
            {% endif %}
        </div>
        <div class="rowe" style="width: 18em; text-align: right;">
            {% if lm_sorted %}
                {% if m.sc_my > m.sc_op %}<strong>{% endif %}
                <a href="/players/{{ lm_player.id }}/">{{ lm_player.tag }}</a>
                {% if lm_player.country != "" %}
                    <img src="http://aligulac.com:81/al/flags/{{ lm_player.country|lower }}.png" alt="{{ lm_player.country }}" />
                {% endif %}
                <img src="http://aligulac.com:81/al/{{ m.rc_my }}.png" alt="{{ m.rc_my }}" class="btm" />
                {% if m.sc_my > m.sc_op %}</strong>{% endif %}
            {% else %}
                {% if m.sca > m.scb %}<strong>{% endif %}
                <a href="/players/{{ m.pla.id }}/">{{ m.pla.tag }}</a>
                {% if m.pla.country != "" %}
                    <img src="http://aligulac.com:81/al/flags/{{ m.pla.country|lower }}.png" alt="{{ m.pla.country }}" />
                {% endif %}
                <img src="http://aligulac.com:81/al/{{ m.rca }}.png" alt="{{ m.rca }}" class="btm" />
                {% if m.sca > m.scb %}</strong>{% endif %}
            {% endif %}
        </div>
        <div class="rowe" style="width: 5em; text-align: center;">
            {% if lm_sorted %}
                {{ m.sc_my }}-{{ m.sc_op }}
            {% else %}
                {{ m.sca }}–{{ m.scb }}
            {% endif %}
        </div>
        <div class="rowe" style="width: 18em;">
            {% if lm_sorted %}
                {% if m.sc_op > m.sc_my %}<strong>{% endif %}
                <img src="http://aligulac.com:81/al/{{ m.rc_op }}.png" alt="{{ m.rc_op }}" class="btm" />
                {% if m.plb.country != "" %}
                    <img src="http://aligulac.com:81/al/flags/{{ m.opp.country|lower }}.png" alt="{{ m.opp.country }}" />
                {% endif %}
                <a href="/players/{{ m.opp.id }}/">{{ m.opp.tag }}</a>
                {% if m.sc_op > m.sc_my %}</strong>{% endif %}
            {% else %}
                {% if m.scb > m.sca %}<strong>{% endif %}
                <img src="http://aligulac.com:81/al/{{ m.rcb }}.png" alt="{{ m.rcb }}" class="btm" />
                {% if m.plb.country != "" %}
                    <img src="http://aligulac.com:81/al/flags/{{ m.plb.country|lower }}.png" alt="{{ m.plb.country }}" />
                {% endif %}
                <a href="/players/{{ m.plb.id }}/">{{ m.plb.tag }}</a>
                {% if m.scb > m.sca %}</strong>{% endif %}
            {% endif %}
        </div>
        <div class="rowe" style="width: 7em; text-align: right;">
            {% if lm_sorted %}
                {{ m.rt_op|ratscale }}
            {% endif %}
        </div>
        <div class="rowe" style="text-align: right; width: 5em;">
            {% if lm_adm %}
                {% if not lm_nocheck %}<input type="checkbox" name="match-{{ m.id }}" value="y" />{% endif %}
                <a href="/admin/ratings/match/{{ m.id }}/">→</a>
            {% else %}
                {% if m.treated %}
                    <img src="http://aligulac.com:81/al/yes.png" alt="yes" class="btm" />
                {% else %}
                    <img src="http://aligulac.com:81/al/no.png" alt="yes" class="btm" />
                {% endif %}
            {% endif %}
        </div>
    </div>
    {% endfor %}
</div>
